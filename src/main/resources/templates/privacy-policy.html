<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/main :: head}">
    <title>Privacy Policy - Eshal Hajj & Umrah Store</title>
</head>
<body class="bg-gray-50">
    <!-- Include auth modals -->
    <div th:replace="~{layout/auth-modals :: auth-modals}"></div>

    <!-- Navbar -->
    <nav th:replace="~{layout/main :: nav}"></nav>

    <!-- Main Content -->
    <div class="pt-32 md:pt-24">
        <div class="container mx-auto px-4 py-8">
            <div class="max-w-4xl mx-auto">
                <h1 class="text-3xl font-bold mb-8 text-primary-dark mt-8">Privacy Policy</h1>
                
                <div class="bg-white rounded-lg shadow-md p-8">
                    <div class="prose prose-lg max-w-none">

                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">1. Introduction</h2>
                        <p class="mb-6">Eshal Hajj & Umrah Store ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you visit our website or make purchases from us. By using our services, you consent to the data practices described in this policy.</p>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">2. Information We Collect</h2>
                        
                        <h3 class="text-xl font-semibold text-primary-dark mb-3">2.1 Personal Information</h3>
                        <p class="mb-4">We may collect the following personal information:</p>
                        <ul class="list-disc pl-6 mb-6 space-y-2">
                            <li>Name and contact information (email address, phone number)</li>
                            <li>Billing and shipping addresses</li>
                            <li>Payment information (processed securely through Razorpay)</li>
                            <li>Account credentials (username, password)</li>
                            <li>Order history and preferences</li>
                            <li>Communication preferences</li>
                        </ul>
                        
                        <h3 class="text-xl font-semibold text-primary-dark mb-3">2.2 Automatically Collected Information</h3>
                        <p class="mb-4">When you visit our website, we automatically collect:</p>
                        <ul class="list-disc pl-6 mb-6 space-y-2">
                            <li>IP address and device information</li>
                            <li>Browser type and version</li>
                            <li>Operating system</li>
                            <li>Pages visited and time spent on pages</li>
                            <li>Referring website</li>
                            <li>Cookies and similar tracking technologies</li>
                        </ul>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">3. How We Use Your Information</h2>
                        <p class="mb-4">We use the collected information for the following purposes:</p>
                        <ul class="list-disc pl-6 mb-6 space-y-2">
                            <li>Process and fulfill your orders</li>
                            <li>Communicate with you about your orders and account</li>
                            <li>Send marketing communications (with your consent)</li>
                            <li>Improve our website and services</li>
                            <li>Provide customer support</li>
                            <li>Comply with legal obligations</li>
                            <li>Prevent fraud and ensure security</li>
                        </ul>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">4. Information Sharing and Disclosure</h2>
                        <p class="mb-4">We do not sell, trade, or rent your personal information to third parties. However, we may share your information in the following circumstances:</p>
                        
                        <h3 class="text-xl font-semibold text-primary-dark mb-3">4.1 Service Providers</h3>
                        <p class="mb-4">We may share your information with trusted third-party service providers who assist us in:</p>
                        <ul class="list-disc pl-6 mb-6 space-y-2">
                            <li>Payment processing (Razorpay)</li>
                            <li>Order fulfillment and shipping</li>
                            <li>Website hosting and maintenance</li>
                            <li>Customer support services</li>
                            <li>Analytics and marketing services</li>
                        </ul>
                        
                        <h3 class="text-xl font-semibold text-primary-dark mb-3">4.2 Legal Requirements</h3>
                        <p class="mb-6">We may disclose your information if required by law or in response to valid legal requests, such as subpoenas or court orders.</p>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">5. Data Security</h2>
                        <p class="mb-4">We implement appropriate technical and organizational measures to protect your personal information against unauthorized access, alteration, disclosure, or destruction. These measures include:</p>
                        <ul class="list-disc pl-6 mb-6 space-y-2">
                            <li>SSL encryption for data transmission</li>
                            <li>Secure payment processing through Razorpay</li>
                            <li>Regular security assessments</li>
                            <li>Access controls and authentication</li>
                            <li>Data backup and recovery procedures</li>
                        </ul>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">6. Cookies and Tracking Technologies</h2>
                        <p class="mb-4">We use cookies and similar technologies to enhance your browsing experience. These technologies help us:</p>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li>Remember your preferences and settings</li>
                            <li>Analyze website traffic and usage patterns</li>
                            <li>Provide personalized content and recommendations</li>
                            <li>Improve website functionality</li>
                        </ul>
                        <p class="mb-6">You can control cookie settings through your browser preferences. However, disabling certain cookies may affect website functionality.</p>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">7. Your Rights and Choices</h2>
                        <p class="mb-4">Under applicable Indian laws, you have the following rights regarding your personal information:</p>
                        <ul class="list-disc pl-6 mb-6 space-y-2">
                            <li><strong>Access:</strong> Request access to your personal information</li>
                            <li><strong>Correction:</strong> Request correction of inaccurate information</li>
                            <li><strong>Deletion:</strong> Request deletion of your personal information</li>
                            <li><strong>Portability:</strong> Request a copy of your data in a portable format</li>
                            <li><strong>Objection:</strong> Object to processing of your personal information</li>
                            <li><strong>Withdrawal:</strong> Withdraw consent for marketing communications</li>
                        </ul>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">8. Marketing Communications</h2>
                        <p class="mb-4">We may send you marketing communications about our products and services. You can opt out of these communications at any time by:</p>
                        <ul class="list-disc pl-6 mb-6 space-y-2">
                            <li>Clicking the unsubscribe link in our emails</li>
                            <li>Contacting us directly</li>
                            <li>Updating your account preferences</li>
                        </ul>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">9. Data Retention</h2>
                        <p class="mb-6">We retain your personal information for as long as necessary to fulfill the purposes outlined in this policy, unless a longer retention period is required or permitted by law. We will delete or anonymize your information when it is no longer needed.</p>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">10. Children's Privacy</h2>
                        <p class="mb-6">Our website is not intended for children under the age of 18. We do not knowingly collect personal information from children under 18. If you believe we have collected information from a child under 18, please contact us immediately.</p>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">11. International Data Transfers</h2>
                        <p class="mb-6">Your personal information may be transferred to and processed in countries other than India. We ensure that such transfers comply with applicable data protection laws and implement appropriate safeguards to protect your information.</p>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">12. Changes to This Privacy Policy</h2>
                        <p class="mb-6">We may update this Privacy Policy from time to time. We will notify you of any material changes by posting the new policy on our website and updating the "Last updated" date. Your continued use of our services after such changes constitutes acceptance of the updated policy.</p>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">13. Contact Us</h2>
                        <p class="mb-6">If you have any questions about this Privacy Policy or our data practices, please contact us at:</p>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="mb-2"><strong>Email:</strong> eshalumrahessentials@gmail.com</p>
                            <p class="mb-2"><strong>Phone:</strong> (+91) 9923067286 / 9764417286 / 7030890979</p>
                            <p class="mb-2"><strong>Address:</strong> Shop No. 5, Building No. 5, HM Royal Society, Near Talab Masjid, Kondhwa, Pune - 411 048</p>
                            <p class="mb-2"><strong>Business Hours:</strong> Monday to Saturday, 9:00 AM to 6:00 PM</p>
                            <p class="mb-2"><strong>Response Time:</strong> Within 24 hours</p>
                        </div>
                        
                        <h2 class="text-2xl font-semibold text-primary-dark mb-4">14. Grievance Redressal</h2>
                        <p class="mb-6">If you have any grievances regarding the processing of your personal information, you may contact our Grievance Officer at grievance@eshaltravels.com. We will respond to your grievance within 30 days.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer th:replace="~{layout/main :: footer}"></footer>

    <!-- Scripts -->
    <script src="/js/auth.js"></script>
    <script src="/js/cart.js"></script>
    <script src="/js/checkout.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="/js/countries2.js"></script>
    <script>
        // Global auth state
        let isAuthenticated = false;

        // Check auth status and update UI when page loads
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                const response = await fetch('/api/auth/check', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    credentials: 'include'
                });

                if (!response.ok) {
                    throw new Error('Failed to check auth status');
                }

                const data = await response.json();
                isAuthenticated = data.authenticated;

                const cartLink = document.getElementById('cartLink');
                const mobileCartLink = document.getElementById('mobileCartLink');
                const loginRegisterLink = document.getElementById('loginRegisterLink');
                const logoutLink = document.getElementById('logoutLink');

                // Always show cart links
                if (cartLink) cartLink.classList.remove('hidden');
                if (mobileCartLink) mobileCartLink.classList.remove('hidden');

                if (isAuthenticated) {
                    loginRegisterLink.classList.add('hidden');
                    logoutLink.classList.remove('hidden');
                    
                    // Check if user is admin and show admin menu
                    if (data.user && data.user.role === 'ROLE_ADMIN') {
                        console.log('User is admin, showing admin dropdown');
                        const adminDropdown = document.getElementById('adminDropdown');
                        const mobileAdminMenu = document.getElementById('mobileAdminMenu');
                        if (adminDropdown) {
                            adminDropdown.classList.remove('hidden');
                            console.log('Admin dropdown shown');
                        }
                        if (mobileAdminMenu) {
                            mobileAdminMenu.classList.remove('hidden');
                            console.log('Mobile admin menu shown');
                        }
                    } else {
                        console.log('User is not admin, role:', data.user?.role);
                    }
                } else {
                    loginRegisterLink.classList.remove('hidden');
                    logoutLink.classList.add('hidden');
                }

                // Always update cart count
                if (typeof updateCartCount === 'function') {
                    await updateCartCount();
                }
            } catch (error) {
                console.error('Error checking auth status:', error);
            }
        });

        // Add logout handler
        document.getElementById('logoutLink').addEventListener('click', async function(e) {
            e.preventDefault();
            try {
                const response = await fetch('/api/auth/logout', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    credentials: 'include'
                });
                if (response.ok) {
                    isAuthenticated = false;
                    
                    // Try to parse JSON response first
                    try {
                        const data = await response.json();
                        if (data.success && data.redirect) {
                            window.location.href = data.redirect;
                        } else {
                            window.location.href = '/';
                        }
                    } catch (e) {
                        // If not JSON, just redirect to home
                        window.location.href = '/';
                    }
                }
            } catch (error) {
                console.error('Logout error:', error);
                // Even if there's an error, redirect to home to clear the session
                window.location.href = '/';
            }
        });

        // Add login/register modal handler
        document.getElementById('loginRegisterLink').addEventListener('click', function(e) {
            e.preventDefault();
            const loginModal = document.getElementById('loginModal');
            if (loginModal) {
                showModal(loginModal);
            } else {
                console.error('Login modal not found');
            }
        });

        // Export auth state for other scripts
        window.getAuthState = function() {
            return isAuthenticated;
        };

        // Add this to your existing script section
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle
            const mobileMenuButton = document.querySelector('.mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            
            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => {
                    const expanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
                    mobileMenuButton.setAttribute('aria-expanded', !expanded);
                    mobileMenu.classList.toggle('hidden');
                    mobileMenuButton.querySelector('svg.block').classList.toggle('hidden');
                    mobileMenuButton.querySelector('svg.hidden').classList.toggle('hidden');
                });
            }

            // Mobile Products dropdown toggle
            const mobileProductsButton = document.getElementById('mobileProductsButton');
            const mobileProductsMenu = document.getElementById('mobileProductsMenu');
            
            if (mobileProductsButton && mobileProductsMenu) {
                mobileProductsButton.addEventListener('click', () => {
                    mobileProductsMenu.classList.toggle('hidden');
                });
            }

            // Desktop Products dropdown behavior
            const productsDropdown = document.getElementById('productsDropdown');
            const productsMenu = document.getElementById('productsMenu');
            let dropdownTimeout;

            if (productsDropdown && productsMenu) {
                productsDropdown.addEventListener('mouseenter', () => {
                    clearTimeout(dropdownTimeout);
                    productsMenu.classList.remove('opacity-0', 'invisible');
                    productsMenu.classList.add('opacity-100', 'visible');
                });

                productsDropdown.addEventListener('mouseleave', () => {
                    dropdownTimeout = setTimeout(() => {
                        productsMenu.classList.remove('opacity-100', 'visible');
                        productsMenu.classList.add('opacity-0', 'invisible');
                    }, 300); // 300ms delay before hiding
                });
            }

            // Admin dropdown toggle
            const adminMenuButton = document.getElementById('adminMenuButton');
            const adminMenu = document.getElementById('adminMenu');
            
            if (adminMenuButton && adminMenu) {
                adminMenuButton.addEventListener('click', () => {
                    adminMenu.classList.toggle('hidden');
                });
                
                // Close admin menu when clicking outside
                document.addEventListener('click', (event) => {
                    if (!adminMenuButton.contains(event.target) && !adminMenu.contains(event.target)) {
                        adminMenu.classList.add('hidden');
                    }
                });
            }

            // Update mobile menu items when auth state changes
            const updateMobileMenu = (isAuthenticated) => {
                const mobileLoginRegisterLink = document.getElementById('mobileLoginRegisterLink');
                const mobileLogoutLink = document.getElementById('mobileLogoutLink');

                if (isAuthenticated) {
                    if (mobileLoginRegisterLink) mobileLoginRegisterLink.classList.add('hidden');
                    if (mobileLogoutLink) mobileLogoutLink.classList.remove('hidden');
                } else {
                    if (mobileLoginRegisterLink) mobileLoginRegisterLink.classList.remove('hidden');
                    if (mobileLogoutLink) mobileLogoutLink.classList.add('hidden');
                }
            };

            // Add mobile logout handler
            const mobileLogoutLink = document.getElementById('mobileLogoutLink');
            if (mobileLogoutLink) {
                mobileLogoutLink.addEventListener('click', async function(e) {
                    e.preventDefault();
                    try {
                        const response = await fetch('/api/auth/logout', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-Requested-With': 'XMLHttpRequest'
                            },
                            credentials: 'include'
                        });
                        if (response.ok) {
                            isAuthenticated = false;
                            // Update both desktop and mobile UI
                            updateMobileMenu(false);
                            if (window.updateUI) {
                                window.updateUI(false);
                            }
                            
                            // Try to parse JSON response first
                            try {
                                const data = await response.json();
                                if (data.success && data.redirect) {
                                    window.location.href = data.redirect;
                                } else {
                                    window.location.href = '/';
                                }
                            } catch (e) {
                                // If not JSON, just redirect to home
                                window.location.href = '/';
                            }
                        }
                    } catch (error) {
                        console.error('Logout error:', error);
                        // Even if there's an error, redirect to home to clear the session
                        window.location.href = '/';
                    }
                });
            }

            // Add mobile login/register handler
            const mobileLoginRegisterLink = document.getElementById('mobileLoginRegisterLink');
            if (mobileLoginRegisterLink) {
                mobileLoginRegisterLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    const loginModal = document.getElementById('loginModal');
                    if (loginModal) {
                        showModal(loginModal);
                    }
                });
            }

            // Override the global updateUI function to handle both desktop and mobile
            const originalUpdateUI = window.updateUI;
            window.updateUI = function(isAuthenticated) {
                // Call original updateUI for desktop
                if (originalUpdateUI) {
                    originalUpdateUI(isAuthenticated);
                }
                // Update mobile menu
                updateMobileMenu(isAuthenticated);
                // Update cart count if authenticated
                if (isAuthenticated && typeof window.updateCartCount === 'function') {
                    window.updateCartCount();
                }
            };

            // Initial state setup
            const checkInitialAuthState = async () => {
                try {
                    const response = await fetch('/api/auth/check', {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        credentials: 'include'
                    });

                    if (response.ok) {
                        const data = await response.json();
                        isAuthenticated = data.authenticated;
                        // Update both desktop and mobile UI
                        updateMobileMenu(isAuthenticated);
                        if (window.updateUI) {
                            window.updateUI(isAuthenticated);
                        }
                    }
                } catch (error) {
                    console.error('Error checking auth status:', error);
                }
            };

            // Check initial auth state
            checkInitialAuthState();

            // Add event listener for cart updates
            document.addEventListener('cartUpdated', function() {
                if (isAuthenticated && typeof window.updateCartCount === 'function') {
                    window.updateCartCount();
                }
            });
        });
    </script>
</body>
</html> 